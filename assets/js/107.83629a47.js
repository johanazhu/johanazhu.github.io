(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{547:function(t,s,a){"use strict";a.r(s);var e=a(25),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"dockerfile-指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-指令"}},[t._v("#")]),t._v(" dockerfile 指令")]),t._v(" "),a("h2",{attrs:{id:"指令速查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指令速查"}},[t._v("#")]),t._v(" 指令速查")]),t._v(" "),a("p",[a("code",[t._v("FROM")]),t._v(" \t基于什么")]),t._v(" "),a("p",[a("code",[t._v("LABEL")]),t._v(" \t制作者的信息")]),t._v(" "),a("p",[a("code",[t._v("ADD . xx")]),t._v("  \t复制文件至容器")]),t._v(" "),a("p",[a("code",[t._v("WORKDIR xx")]),t._v("\t进入工作目录")]),t._v(" "),a("p",[a("code",[t._v("RUN npm install")]),t._v("\t安装依赖包")]),t._v(" "),a("p",[a("code",[t._v("EXPOSE")]),t._v(" \t端口")]),t._v(" "),a("p",[a("code",[t._v("COPY")]),t._v("\t\t复制")]),t._v(" "),a("p",[a("code",[t._v("RUN")]),t._v("\t后面跟着命令行命令")]),t._v(" "),a("p",[a("code",[t._v("CMD")]),t._v(" \t类似于RUN 指令，用于运行程序")]),t._v(" "),a("ul",[a("li",[t._v("CMD 在 docker run 时运行")]),t._v(" "),a("li",[t._v("RUN 是在docker build")])]),t._v(" "),a("p",[a("code",[t._v("VOLUME")]),t._v(" \t定义匿名数据卷")]),t._v(" "),a("h2",{attrs:{id:"volume"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#volume"}},[t._v("#")]),t._v(" VOLUME")]),t._v(" "),a("p",[a("code",[t._v("VOLUME")]),t._v(" \t定义匿名数据卷。在启动容器是")]),t._v(" "),a("p",[t._v("作用：")]),t._v(" "),a("ul",[a("li",[t._v("避免重要的数据，因容器重启而丢失，这是非常致命的")]),t._v(" "),a("li",[t._v("避免容器不断变大")])]),t._v(" "),a("p",[t._v("格式：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("VOLUME "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<路径1>"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"路径2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("在启动容器 docker run 的时候，我们可以通过 -v 参数修改挂载点")]),t._v(" "),a("h2",{attrs:{id:"label"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#label"}},[t._v("#")]),t._v(" LABEL")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('LABEL version="1.0" description="这是一个Web服务器" by="IT笔录\n')])])]),a("h2",{attrs:{id:"例子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[t._v("#")]),t._v(" 例子")]),t._v(" "),a("div",{staticClass:"language-dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# base image")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" johanbo/ubuntu_node:v1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 复制文件到容器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" . /var/www")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入工作目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WORKDIR")]),t._v(" /var/www")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装项目依赖包")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" npm install --registry=https://registry.npm.taobao.org")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 暴露 端口")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 3010")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开始命令")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CMD")]),t._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pm2"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app.js"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--no-daemon"')]),t._v("]")]),t._v("\n\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);