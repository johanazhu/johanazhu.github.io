(window.webpackJsonp=window.webpackJsonp||[]).push([[272],{729:function(t,a,s){"use strict";s.r(a);var n=s(25),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"用-node-搭建最小实现脚手架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用-node-搭建最小实现脚手架"}},[t._v("#")]),t._v(" 用 Node 搭建最小实现脚手架")]),t._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),s("p",[t._v("本节讲解使用 Node 来做一个脚手架，便于快速开发项目。我们开发的是脚手架，而非项目，目前本人只有一个基础 "),s("a",{attrs:{href:"https://github.com/johanazhu/koa-basic",target:"_blank",rel:"noopener noreferrer"}},[t._v("Koa 脚手架"),s("OutboundLink")],1),t._v(" ，后续写到 React、webpack 时，会搭建属于自己的一套 H5 端的开发模板。本文以实现最小脚手架为出发点展开写作，后续也会再次基础上添砖加瓦")]),t._v(" "),s("h2",{attrs:{id:"引子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引子"}},[t._v("#")]),t._v(" 引子")]),t._v(" "),s("p",[t._v("A：大B哥，Node 能做什么？")]),t._v(" "),s("p",[t._v("B：搭建 Web 服务噜")]),t._v(" "),s("p",[t._v("A：不仅如此，它还能操作系统")]),t._v(" "),s("p",[t._v("B：怎么说？")]),t._v(" "),s("p",[t._v("A：知道 Webpack 吗？它就是用 Node 写的。还有像"),s("a",{attrs:{href:"https://github.com/facebook/create-react-app",target:"_blank",rel:"noopener noreferrer"}},[t._v(" create-react-app"),s("OutboundLink")],1),t._v("、 "),s("a",{attrs:{href:"https://github.com/vuejs/vue-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-cli"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://github.com/NervJS/taro/tree/next/packages/taro-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("@tarojs/cli"),s("OutboundLink")],1),t._v(" 这些，都是用 Node 写的，这些 cli 被称为脚手架，你只要使用一些命令就能下载模板快速开发")]),t._v(" "),s("p",[t._v("B：（各种羡慕、吹捧后），我也想做一套自己的脚手架")]),t._v(" "),s("p",[t._v("A：我教你啊")]),t._v(" "),s("h2",{attrs:{id:"一个脚手架的思路"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一个脚手架的思路"}},[t._v("#")]),t._v(" 一个脚手架的思路")]),t._v(" "),s("p",[t._v("看 "),s("a",{attrs:{href:"https://github.com/facebook/create-react-app",target:"_blank",rel:"noopener noreferrer"}},[t._v(" create-react-app"),s("OutboundLink")],1),t._v("、 "),s("a",{attrs:{href:"https://github.com/vuejs/vue-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-cli"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://github.com/NervJS/taro/tree/next/packages/taro-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("@tarojs/cli"),s("OutboundLink")],1),t._v(" 的各自的仓库，我们能出一些共同点，例如多套模板、友好的交互、优美的UI等等。我们这里以 taro 为例，先用用，看看，再仿着做一个")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.loli.net/2021/08/31/8NhJZHDseSbmncq.png",alt:"使用taro-cli创建项目"}})]),t._v(" "),s("p",[t._v("它是怎么做到选择不同的模板，能生成不同的文件呢？明明只有一个基础模板啊，选择 scss 就生成 scss 文件，选择 TypeScript 生成 TS 文件，现在还看不懂源码，以后写完 webpack 再来看看，我们这里只先做一个最简单的脚手架")]),t._v(" "),s("h2",{attrs:{id:"创建工程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建工程"}},[t._v("#")]),t._v(" 创建工程")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" azhu-cli\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" azhu-cli\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" init -y\n")])])]),s("p",[t._v("然后在 package.json 中写点项目信息")]),t._v(" "),s("h2",{attrs:{id:"需要安装的-npm-包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#需要安装的-npm-包"}},[t._v("#")]),t._v(" 需要安装的 npm 包")]),t._v(" "),s("p",[t._v("我们先列个表格，查看一下各个 npm 包是什么，有什么用，后续在写代码时一步步添加进去")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("包名称")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("a",{attrs:{href:"https://www.npmjs.com/package/commander",target:"_blank",rel:"noopener noreferrer"}},[t._v("commander"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("执行复杂的命令")])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"https://www.npmjs.com/package/inquirer",target:"_blank",rel:"noopener noreferrer"}},[t._v("inquirer"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("问答交互")])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"https://www.npmjs.com/package/download-git-repo",target:"_blank",rel:"noopener noreferrer"}},[t._v("download-git-repo"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("下载远程模板")])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"https://www.npmjs.com/package/chalk",target:"_blank",rel:"noopener noreferrer"}},[t._v("chalk"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("让你 console.log 出来的字带颜色，比如成功时的绿色字")])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"https://www.npmjs.com/package/ora",target:"_blank",rel:"noopener noreferrer"}},[t._v("ora"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("loading")])])])]),t._v(" "),s("h2",{attrs:{id:"创建一个命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建一个命令"}},[t._v("#")]),t._v(" 创建一个命令")]),t._v(" "),s("p",[t._v("先创建 "),s("code",[t._v("index.js")]),t._v("，在代码中写入")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token hashbang comment"}},[t._v("#!/usr/bin/env node")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("在终端中运行 node 程序，输入 node 命令")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("node index.js\n")])])]),s("p",[t._v("可以正确输出 "),s("code",[t._v("hello world")]),t._v(" ，代码顶部的 "),s("code",[t._v("#!/usr/bin/env node")]),t._v(" 是告诉终端，这个文件要使用 node 去执行")]),t._v(" "),s("p",[t._v("一般 cli 都有一个特定的命令，例如 "),s("code",[t._v("taro")]),t._v("，"),s("code",[t._v("git")]),t._v(" 等，我们设置我们的命令—— "),s("code",[t._v("azhu")]),t._v("。如何让终端识别这个命令呢？很简单，在 package.json 文件中添加一个字段 "),s("code",[t._v("bin")]),t._v("，并且声明一个命令关键字和对应执行的文件：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("# package.json\n...\n"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bin"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"azhu"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"index.js"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n...\n")])])]),s("p",[t._v("然后我们测试一番，在终端中输入 "),s("code",[t._v("azhu")]),t._v("，会提示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.loli.net/2021/08/31/Ua9hHfQcjwxYAV3.png",alt:"azhu错误"}})]),t._v(" "),s("p",[t._v("为什么会这样呢？通常我们在使用 cli 工具时，都需要先安装它，比如 vue-cli，@tarojs/cli，使用前需要全局安装：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i vue-cli -g\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g @tarojs/cli\n")])])]),s("p",[t._v("而我们的 azhu-cli 并没有发布到 npm 上，当然也没有安装过，所以终端现在还不认识这个命令。通常我们想本地测试一个 npm 包，可以使用 "),s("code",[t._v("npm link")]),t._v(" 这个命令，本地安装这个包，我们执行一下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v("\n")])])]),s("p",[t._v("再执行 "),s("code",[t._v("azhu")]),t._v(" 命令，就看到 "),s("code",[t._v("hello world")]),t._v(" 了")]),t._v(" "),s("blockquote",[s("p",[t._v("注：npm unlink 卸载本地包")])]),t._v(" "),s("h2",{attrs:{id:"执行复杂的命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行复杂的命令"}},[t._v("#")]),t._v(" 执行复杂的命令")]),t._v(" "),s("p",[t._v("commander：处理命令行交互")]),t._v(" "),s("ul",[s("li",[t._v("自带了 -V，-h 交互")]),t._v(" "),s("li",[t._v("可以通过 "),s("code",[t._v("program.command")]),t._v(" 添加交互")]),t._v(" "),s("li",[s("code",[t._v("program.parse")]),t._v(" 将命令参数传入 commander 管道中，一般放在最后执行")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i commander --save\n")])])]),s("p",[t._v("改造 "),s("code",[t._v("index.js")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token hashbang comment"}},[t._v("#!/usr/bin/env node")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" program "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'commander'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./package.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nprogram"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nprogram"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("运行 "),s("code",[t._v("azhu -h")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.loli.net/2021/08/31/a2B5ng9rfWT8zks.png",alt:"commander处理"}})]),t._v(" "),s("h2",{attrs:{id:"添加问答操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加问答操作"}},[t._v("#")]),t._v(" 添加问答操作")]),t._v(" "),s("p",[t._v("inquirer 添加问答操作")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i inquirer --save\n")])])]),s("p",[t._v("语法很简单，直接看代码：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("inquirer\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("prompt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'input'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        message"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请输入项目名称'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        message"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请选择项目模板'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'template'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        choices"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'koa-basic'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("answers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'answers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" answers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("每个选项中的 name 为答案输出的值")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.loli.net/2021/09/01/5dD3YqCer76Pmzl.png",alt:"inquirer"}})]),t._v(" "),s("h2",{attrs:{id:"克隆模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#克隆模板"}},[t._v("#")]),t._v(" 克隆模板")]),t._v(" "),s("p",[t._v("download-git-repo")]),t._v(" "),s("ul",[s("li",[t._v("下载远程模板")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i download-git-repo --save\n")])])]),s("p",[t._v("原本使用 shelljs，但是死活下载不下来，只能选择另一个工具")]),t._v(" "),s("p",[t._v("当我们下载写好项目名字，选择好模板后，下一步就要从远程仓库上把模板下载过来")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("answers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'正在拷贝项目，请稍等'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" remote "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://github.com:johanazhu/koa-basic#master'")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tarName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" answers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("download")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("remote"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tarName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" clone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'成功'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"添加ui交互"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加ui交互"}},[t._v("#")]),t._v(" 添加UI交互")]),t._v(" "),s("p",[t._v("有时候下载远程仓库时会花很多时间，我们必须为了体验，需要加一些 UI 效果优化体验")]),t._v(" "),s("p",[t._v("chalk & ora")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i chalk ora --save\n")])])]),s("p",[t._v("chalk 是给 console 加颜色")]),t._v(" "),s("p",[t._v("ora 是加 loading 效果的")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("answers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'正在拷贝项目，请稍等'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" remote "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://github.com:johanazhu/koa-basic#master'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tarName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" answers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" spinner "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ora")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'download template......'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("download")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("remote"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tarName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" clone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chalk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("red")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            spinner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fail")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chalk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("green")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'成功'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            spinner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("succeed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("效果如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.loli.net/2021/09/01/tTVFrSi431Xy6dH.png",alt:"chalk&ora"}})]),t._v(" "),s("h2",{attrs:{id:"发布-npm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#发布-npm"}},[t._v("#")]),t._v(" 发布 npm")]),t._v(" "),s("p",[t._v("先登录 npm，再发布")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" login\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" publish\n")])])]),s("h2",{attrs:{id:"额外知识点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#额外知识点"}},[t._v("#")]),t._v(" 额外知识点")]),t._v(" "),s("h3",{attrs:{id:"包管理方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#包管理方式"}},[t._v("#")]),t._v(" 包管理方式")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.loli.net/2021/08/31/BbwqCXi4p2h7Ttd.png",alt:"包管理方式对比"}})]),t._v(" "),s("h4",{attrs:{id:"monorepo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#monorepo"}},[t._v("#")]),t._v(" monorepo")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("将多个项目代码存储在一个仓库力的软件开发策略")])]),t._v(" "),s("li",[s("p",[t._v("把所有的项目相关都放在一个仓库（比如React，Babel，Umi，Taro）")])]),t._v(" "),s("li",[s("p",[t._v("集中管理")])]),t._v(" "),s("li",[s("p",[t._v("优势")]),t._v(" "),s("ul",[s("li",[t._v("统一工作流")]),t._v(" "),s("li",[t._v("降低基建成本")]),t._v(" "),s("li",[t._v("提高团队协作效率")])])]),t._v(" "),s("li",[s("p",[t._v("劣势")]),t._v(" "),s("ul",[s("li",[t._v("体积问题")]),t._v(" "),s("li",[t._v("权限问题")]),t._v(" "),s("li",[t._v("版本控制")])])])]),t._v(" "),s("h4",{attrs:{id:"multirepo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#multirepo"}},[t._v("#")]),t._v(" multirepo")]),t._v(" "),s("ul",[s("li",[t._v("按模块放在为多个仓库（webpack、rollup）")]),t._v(" "),s("li",[t._v("优势\n"),s("ul",[s("li",[t._v("灵活")]),t._v(" "),s("li",[t._v("安全")])])]),t._v(" "),s("li",[t._v("劣势\n"),s("ul",[s("li",[t._v("代码复用")]),t._v(" "),s("li",[t._v("版本管理")]),t._v(" "),s("li",[t._v("开发调试")]),t._v(" "),s("li",[t._v("搭建基础架构")])])])]),t._v(" "),s("p",[t._v("大的项目可以使用monorepo，独立性比较强的可以采用 multirepo")]),t._v(" "),s("p",[t._v("我个人更喜欢 multirepo 的哲学")]),t._v(" "),s("p",[t._v("有人上升到哲学层面，其实按觉得是不用的项目采用适合自己的管理方式，像 webpack、rollup 之类，项目独立想比较强，就可以用使用 multirepo ，而像 React，Umi，Taro 之类的框架，它首先要拆分功能点，其次每个子库之间需要与主库有所依赖，如果采用 multirepo 方式，关联起来会很麻烦，采用统一管理的方式能节省很多时间")]),t._v(" "),s("h2",{attrs:{id:"常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),s("p",[t._v("一：使用 "),s("code",[t._v("shelljs")]),t._v(" 常有报错，暂时解决不了，所以用 "),s("code",[t._v("download-git-repo")]),t._v(" 这种方式")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("fatal: unable to access "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://github.com/johanazhu/koa-basic/'")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" OpenSSL SSL_read: Connection was reset, errno "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10054")]),t._v("\n")])])]),s("p",[t._v("解决方案")]),t._v(" "),s("p",[t._v("打开 Git 命令页面，执行 git 命令脚本：修改设置，解除 ssl 验证")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" config --global http.sslVerify "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("注：git config --list 查看你的 config 信息")])]),t._v(" "),s("p",[t._v("二："),s("code",[t._v("download-git-repo")]),t._v(" 报错误")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'git clone'")]),t._v(" failed with status "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v("\n")])])]),s("p",[t._v("解决方案："),s("a",{attrs:{href:"https://github.com/wuqiong7/Note/issues/17",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/wuqiong7/Note/issues/17"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("我将 remote 地址改成："),s("a",{attrs:{href:"https://github.com:johanazhu/koa-basic#master",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com:johanazhu/koa-basic#master"),s("OutboundLink")],1),t._v(" 就好了")]),t._v(" "),s("p",[t._v("Github已发布："),s("a",{attrs:{href:"https://github.com/johanazhu/azhu-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/johanazhu/azhu-cli"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/imaoda/js-front-end-practice/blob/master/%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%84%9A%E6%89%8B%E6%9E%B6.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("搭建一个企业级脚手架"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/CO6La0NCHnsfXN4MHgiBag",target:"_blank",rel:"noopener noreferrer"}},[t._v("从零开发一个node命令行工具"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);