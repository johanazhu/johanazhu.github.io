(window.webpackJsonp=window.webpackJsonp||[]).push([[309],{767:function(t,s,a){"use strict";a.r(s);var n=a(25),p=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("最近团队在开发组件UI化，笔者正参与其中，团队内使用的是阿里巴巴开源的UmiJS，脚手架提供了文件编写和组件开发所需要的所有配置，加上以typescript来写组件，由rollup打包应用，使得组件的质量和体积有了一定的保障。")]),t._v(" "),a("p",[t._v("但，作为一名开发，不能仅仅满足对业务组件的实现，更应该对其原理进行探索。本文不对UmiJS的源码进行探讨，浅析一个微小组件如何开发到展示，实现从零到发布一个组件的全过程。")]),t._v(" "),a("p",[t._v("所需知识量：了解webpack基本配置，npm以及react")]),t._v(" "),a("p",[t._v("第一步：npm init")]),t._v(" "),a("p",[t._v("首先我们需要初始化一个项目，")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" init -y\n")])])]),a("p",[t._v("再在生成的package.json中填上必要的信息。例如 作者名，关键字等等")]),t._v(" "),a("p",[t._v("如下配置")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"react-azhu-btn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"一个微小的组件"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lib/index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"keywords"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"react"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"react-dom"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"azhu"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"component"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"btn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"files"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lib"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"repository"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git@github.com:azhubaby/react-azhu-btn.git"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bugs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://github.com/azhubaby/react-azhu-btn/issues"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("第二步：配置webpack")]),t._v(" "),a("p",[t._v("我们知道webpack是资源打包器，他打包所有的静态资源，但他本身只能打包JavaScript，如果你要打包图片，css甚至是字体，都需要配置相对应的loader。例如以下这次脚手架中所需要的loader")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("loader名")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("babel-loader")]),t._v(" "),a("td",[t._v("解析babel")])]),t._v(" "),a("tr",[a("td",[t._v("style-loader")]),t._v(" "),a("td",[t._v("讲css挂载到文档上")])]),t._v(" "),a("tr",[a("td",[t._v("css-loader")]),t._v(" "),a("td",[t._v("解析css")])]),t._v(" "),a("tr",[a("td",[t._v("postcss-loader")]),t._v(" "),a("td",[t._v("配置postcss中的autoprefixer，可给浏览器加前缀，省去")])]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td")])])]),t._v(" "),a("p",[t._v("笔者最近在开发团队中的UI")]),t._v(" "),a("p",[t._v("用的是umi来开发组件库")]),t._v(" "),a("p",[t._v("umi 的优点罗列出来")]),t._v(" "),a("p",[t._v("umi很好，虽然他很好用，但是我们需要知其所以然，")]),t._v(" "),a("p",[t._v("本文将从零打造一UI组件脚手架，跟上节奏")]),t._v(" "),a("p",[t._v("配置环境，")]),t._v(" "),a("p",[t._v("本次教程采用webpack4来打包（rollup和webpack各有千秋，工作中webpack使用更多，故用之）")]),t._v(" "),a("p",[t._v("html-webpack-plugin")]),t._v(" "),a("p",[t._v("clean-webpack-plugin")]),t._v(" "),a("p",[t._v("css 我们用scss")]),t._v(" "),a("p",[t._v("postcss")]),t._v(" "),a("p",[t._v("对于图标我们使用")]),t._v(" "),a("p",[t._v("file-loader")]),t._v(" "),a("p",[t._v("我们再做一个启动文件来查看我们所做的组件")]),t._v(" "),a("p",[t._v("webpack.example.js")]),t._v(" "),a("p",[t._v("webpack.build.js")]),t._v(" "),a("p",[t._v("打包文件")]),t._v(" "),a("p",[t._v("再将打包上传至 npm 上，")]),t._v(" "),a("p",[t._v("npm login XX")]),t._v(" "),a("p",[t._v("npm publish")]),t._v(" "),a("p",[t._v("我们甚至可以将它写成一个脚本，需要发布时可以npm pushlish")]),t._v(" "),a("p",[t._v("好了，这就是本篇的所有内容，如果觉得还行，请不要吝啬你的“再看”")]),t._v(" "),a("p",[t._v("这是一件简单的微小组件的开发，")]),t._v(" "),a("p",[t._v("如果需要完善，其实还可以加上测试用例，文档撰写功能")]),t._v(" "),a("p",[t._v("测试用例推荐使用 jest，这是目前比较流行的测试工具")]),t._v(" "),a("p",[t._v("文档就有多种选择，如果想单独开发一个库，可使用阿里rc-tools工具，")]),t._v(" "),a("p",[t._v("如果你和我样觉得 rc-tools 的 example 样式太难看，可以看看docz，它也很方便")]),t._v(" "),a("p",[t._v("如果是是个造轮子主义者，不妨看看markdown-it，将它集成在webpack中，我的文档我做主")]),t._v(" "),a("p",[t._v("总之，方案很多，供君细品")]),t._v(" "),a("p",[t._v("babel 相关")]),t._v(" "),a("p",[t._v("https://github.com/Kehao/Blog/issues/1")])])}),[],!1,null,null,null);s.default=p.exports}}]);